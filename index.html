<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Snake — Tamagotchi Style</title>
<style>
  :root{
    --frame:#d6d3ff;
    --border:#5a57a8;
    --bg:#201f3a;
    --snake:#9aff82;
    --food:#ff6b6b;
  }
  html,body{height:100%;margin:0;background:#cfcdfb;display:flex;justify-content:center;align-items:center;font-family:Arial}

  #tama-frame{
    background:var(--frame);
    width:330px;
    height:430px;
    border:6px solid var(--border);
    border-radius:35px;
    box-shadow:0 0 25px rgba(0,0,0,0.25);
    display:flex;
    flex-direction:column;
    align-items:center;
    padding-top:25px;
  }

  #screen{
    background:var(--bg);
    width:260px;
    height:260px;
    border:4px solid var(--border);
    border-radius:12px;
    overflow:hidden;
    display:flex;
    justify-content:center;
    align-items:center;
    margin-bottom:20px;
  }

  canvas{
    width:240px !important;
    height:240px !important;
  }

  #buttons{
    display:flex;
    gap:18px;
  }
  .btn{
    width:45px;
    height:45px;
    background:var(--border);
    border-radius:50%;
    box-shadow:0 3px 0 #3c3a7b;
    cursor:pointer;
  }

  #score{
    margin-top:15px;
    font-size:18px;
    color:#333;
  }
</style>
</head>
<body>

<div id="tama-frame">
  <div id="screen">
    <canvas id="game" width="120" height="120"></canvas>
  </div>

  <div id="buttons">
    <div class="btn" id="btn-left"></div>
    <div class="btn" id="btn-up"></div>
    <div class="btn" id="btn-right"></div>
  </div>
  <div style="display:flex;gap:18px;margin-top:10px">
    <div class="btn" id="btn-down"></div>
    <div class="btn" id="btn-restart"></div>
  </div>

  <div id="score">Puntaje: <span id="points">0</span></div>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
let size=12; // grid pequeño estilo tamagotchi
let snake=[{x:6,y:6}];
let dir={x:1,y:0};
let nextDir={x:1,y:0};
let food=randomFood();
let score=0;

function randomFood(){
  return{ x:Math.floor(Math.random()*size), y:Math.floor(Math.random()*size) };
}

function draw(){
  ctx.fillStyle="#000";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  let c=canvas.width/size;

  // food
  ctx.fillStyle=getComputedStyle(document.documentElement).getPropertyValue('--food')
  ctx.fillRect(food.x*c,food.y*c,c-1,c-1);

  // snake
  ctx.fillStyle=getComputedStyle(document.documentElement).getPropertyValue('--snake')
  snake.forEach(p=>ctx.fillRect(p.x*c,p.y*c,c-1,c-1));
}

let last=0; let speed=4;
function loop(t){
  requestAnimationFrame(loop);
  if(t-last < 1000/speed) return;
  last=t;

  dir=nextDir;
  let head={x:snake[0].x+dir.x,y:snake[0].y+dir.y};

  // wrap estilo tamagotchi
  if(head.x<0) head.x=size-1;
  if(head.x>=size) head.x=0;
  if(head.y<0) head.y=size-1;
  if(head.y>=size) head.y=0;

  // colisión
  if(snake.some(p=>p.x===head.x && p.y===head.y)) return restart();

  snake.unshift(head);

  if(head.x===food.x && head.y===food.y){
    score++;
    document.getElementById('points').textContent=score;
    food=randomFood();
  } else snake.pop();

  draw();
}
requestAnimationFrame(loop);

function restart(){
  snake=[{x:6,y:6}];
  dir={x:1,y:0};
  nextDir={x:1,y:0};
  food=randomFood();
  score=0;
  document.getElementById('points').textContent=0;
}

// buttons
function setDir(dx,dy){ if(dx!==-dir.x || dy!==-dir.y) nextDir={x:dx,y:dy}; }

document.getElementById('btn-left').onclick=()=>setDir(-1,0);
document.getElementById('btn-right').onclick=()=>setDir(1,0);
document.getElementById('btn-up').onclick=()=>setDir(0,-1);
document.getElementById('btn-down').onclick=()=>setDir(0,1);
document.getElementById('btn-restart').onclick=restart;

// keyboard
window.addEventListener('keydown',e=>{
  if(e.key==='ArrowUp') setDir(0,-1);
  if(e.key==='ArrowDown') setDir(0,1);
  if(e.key==='ArrowLeft') setDir(-1,0);
  if(e.key==='ArrowRight') setDir(1,0);
});
</script>

</body>
</html>